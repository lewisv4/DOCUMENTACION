-- phpMyAdmin SQL Dump
-- version 5.0.4
-- https://www.phpmyadmin.net/
--
-- Servidor: localhost
-- Tiempo de generación: 24-01-2021 a las 02:49:39
-- Versión del servidor: 10.4.17-MariaDB
-- Versión de PHP: 8.0.0

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Base de datos: `curso_sql`
--

DELIMITER $$
--
-- Procedimientos
--
CREATE DEFINER=`root`@`localhost` PROCEDURE `ACTUALIZA_PRODUCTOS` (`N_PRECIO` INT, `CODIGO` VARCHAR(4))  UPDATE PRODUCTOS SET PRECIO=N_PRECIO WHERE CÓDIGOARTÍCULO=CODIGO$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `CALCULA_EDAD` (IN `AGNO_NACIMIENTO` INT)  BEGIN

        DECLARE AGNO_ACTUAL INT DEFAULT 2021;

        DECLARE EDAD INT;

        SET EDAD = AGNO_ACTUAL-AGNO_NACIMIENTO;


        SELECT EDAD;

    END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `MUESTRA_CLIENTES` ()  SELECT * FROM CLIENTES WHERE POBLACIÓN = "MADRID"$$

DELIMITER ;

-- --------------------------------------------------------

--
-- Estructura Stand-in para la vista `art_deportes`
-- (Véase abajo para la vista actual)
--
CREATE TABLE `art_deportes` (
`NOMBREARTÍCULO` varchar(19)
,`SECCIÓN` varchar(10)
,`PAÍSDEORIGEN` varchar(9)
);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `CLIENTES`
--

CREATE TABLE `CLIENTES` (
  `CÓDIGOCLIENTE` varchar(4) NOT NULL,
  `EMPRESA` varchar(24) DEFAULT NULL,
  `DIRECCIÓN` varchar(19) DEFAULT NULL,
  `POBLACIÓN` varchar(9) DEFAULT NULL,
  `TELÉFONO` varchar(16) DEFAULT NULL,
  `RESPONSABLE` varchar(17) DEFAULT NULL,
  `HISTORIAL` varchar(10) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Volcado de datos para la tabla `CLIENTES`
--

INSERT INTO `CLIENTES` (`CÓDIGOCLIENTE`, `EMPRESA`, `DIRECCIÓN`, `POBLACIÓN`, `TELÉFONO`, `RESPONSABLE`, `HISTORIAL`) VALUES
('CT01', 'BELTRÁN E HIJOS', NULL, 'MADRID', '(914) 45- 64- 35', NULL, NULL),
('CT02', 'LA MODERNA', 'LA PALOMA 123', 'OVIEDO', '(985) 32- 34- 34', 'JUAN GARCÍA', ''),
('CT03', 'EL ESPAÑOLITO', 'MOTORES 34', 'BARCELONA', '(934) 56- 53- 43', 'ANA FERNÁNDEZ', ''),
('CT04', 'EXPORTASA', NULL, 'MADRID', '(913) 45- 23- 78', NULL, NULL),
('CT06', 'CONFECCIONES AMPARO', 'LOS MOROS 23', 'GIJÓN', '(985) 75- 43- 32', 'LUÍS ÁLVAREZ', ''),
('CT07', 'LA CASA DEL JUGUETE', NULL, 'MADRID', '(912) 64- 99- 87', NULL, NULL),
('CT08', 'JUGUETERÍA SUÁREZ', 'PARIS 123', 'BARCELONA', '(933) 45- 78- 66', 'JUAN GARCÍA', ''),
('CT09', 'ALMACÉN POPULAR', 'LAS FUENTES 124', 'BILBAO', '(942) 34- 71- 27', 'JOSÉ ÁLVAREZ', ''),
('CT10', 'FERETERÍA EL CLAVO', NULL, 'MADRID', '(914) 35- 48- 66', NULL, NULL),
('CT11', 'JUGUETES MARTÍNEZ', 'VIA LAYETANA 245', 'BARCELONA', '(936) 62- 85- 54', 'FRANCISCO CUEVAS', ''),
('CT12', 'FERNÁNDEZ SL', 'PASEO DEL MAR 45', 'SANTANDER', '(942) 04- 95- 86', 'ELISA COLLADO', ''),
('CT13', 'CONFECCIONES ARTÍMEZ', 'GENERAL PERÓN 45', 'A CORUÑA', '(981) 34- 52- 39', 'ESTEBAN PASCUAL', ''),
('CT14', 'DEPORTES GARCÍA', NULL, 'MADRID', '(913) 29- 94- 75', NULL, NULL),
('CT15', 'EXCLUSIVAS FERNÁNDEZ', 'LLOBREGAT 250', 'BARCELONA', '(939) 55- 83- 65', 'LUISA FERNÁNDEZ', ''),
('CT16', 'DEPORTES MORÁN', 'AUTONOMÍA 45', 'LUGO', '(982) 98- 69- 44', 'JOSÉ MANZANO', ''),
('CT17', 'BAZAR FRANCISCO', 'CARMEN 45', 'ZAMORA', '(980) 49- 52- 88', 'CARLOS BELTRÁN', ''),
('CT18', 'JUGUETES LA SONRISA', 'LA BAÑEZA 67', 'LEÓN', '(987) 94- 53- 68', 'FAUSTINO PÉREZ', ''),
('CT19', 'CONFECCIONES GALÁN', NULL, 'MADRID', '(913) 85- 92- 34', NULL, NULL),
('CT20', 'LA CURTIDORA', 'OLIVARES 3', 'MÁLAGA', '(953) 75- 62- 59', 'MARÍA GÓMEZ', ''),
('CT21', 'LÍNEA JOVEN', 'SIERPES 78', 'SEVILLA', '(953) 45- 25- 67', 'ASUNCIÓN SALADO', ''),
('CT22', 'BAZAR EL BARAT', 'DIAGONAL 56', 'BARCELONA', '(936) 69- 28- 66', 'ELISA DAPENA', ''),
('CT23', 'EL PALACIO DE LA MODA', NULL, 'MADRID', '(927) 78- 52- 35', NULL, NULL),
('CT24', 'SÁEZ Y CÍA', 'INFANTA MERCEDS 23', 'SEVILLA', '(954) 86- 92- 34', 'MANUEL GUERRA', ''),
('CT25', 'DEPORTES EL MADRILEÑO', 'CASTILLA 345', 'ZARAGOZA', '(976) 38- 89- 34', 'CARLOS GONZÁLEZ', ''),
('CT26', 'FERRETERÍA LA ESCOBA', NULL, 'MADRID', '(918) 45- 93- 46', NULL, NULL),
('CT27', 'JUGUETES EL BARATO', 'VÍA AUGUSTA 245', 'BARCELONA', '(933) 48- 69- 84', 'ELVIRA IGLESIAS', ''),
('CT28', 'CONFECCIONES HERMINIA', 'CORRIDA 345', 'GIJÓN', '(985) 59- 73- 15', 'ABEL GONZÁLEZ', ''),
('CT30', 'BAZAR EL ARGENTINO', NULL, 'MADRID', '(912) 49- 59- 73', NULL, NULL),
('CT31', 'LA TIENDA ELEGANTE', 'EL COMENDADOR 67', 'ZARAGOZA', '(975) 69- 40- 35', 'JOSÉ PASCUAL', ''),
('CT32', 'DEPORTES NAUTICOS GARCÍA', 'JUAN FERNÁNDEZ 89', 'ÁVILA', '(920) 26- 86- 48', 'JUAN CONRADO', ''),
('CT33', 'CONFECCIONES RUIZ', 'LLOBREGAT 345', 'BARCELONA', '(934) 58- 76- 15', 'CARLOS SANZ', ''),
('CT34', 'BAZAR LA FARAONA', NULL, 'MADRID', '(915) 48- 36- 27', NULL, NULL),
('CT35', 'FERRETERÍA EL MARTILLO', 'CASTELLANOS 205', 'SALAMANCA', '(923) 54- 89- 65', 'JOAQUÍN FERNANDEZ', ''),
('CT36', 'JUGUETES EDUCATIVOS SANZ', NULL, 'MADRID', '(916) 87- 23- 54', NULL, NULL),
('CT37', 'ALMACENES FERNANDEZ', 'ANTÓN 67', 'TERUEL', '(978) 56- 40- 25', 'MARIA ARDANZA', ''),
('CT38', 'CONFECCIONES MÓNICA', 'MOTORES 67', 'BARCELONA', '(935) 68- 12- 45', 'PEDRO SERRANO', ''),
('CT39', 'FERRETERÍA LIMA', NULL, 'MADRID', '(913) 53- 27- 85', NULL, NULL),
('CT40', 'DEPORTES EL BRASILEÑO', 'ABEL MARTÍNEZ 67', 'SALAMANCA', '(921) 54- 87- 62', 'CARLOS GÓMEZ', '');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `CLIENTES_MADRID`
--

CREATE TABLE `CLIENTES_MADRID` (
  `CÓDIGOCLIENTE` varchar(4) CHARACTER SET utf8 NOT NULL,
  `EMPRESA` varchar(24) CHARACTER SET utf8 DEFAULT NULL,
  `DIRECCIÓN` varchar(19) CHARACTER SET utf8 DEFAULT NULL,
  `POBLACIÓN` varchar(9) CHARACTER SET utf8 DEFAULT NULL,
  `TELÉFONO` varchar(16) CHARACTER SET utf8 DEFAULT NULL,
  `RESPONSABLE` varchar(17) CHARACTER SET utf8 DEFAULT NULL,
  `HISTORIAL` varchar(10) CHARACTER SET utf8 DEFAULT NULL,
  `FECHA_BAJA` date DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `CLIENTES_MADRID`
--

INSERT INTO `CLIENTES_MADRID` (`CÓDIGOCLIENTE`, `EMPRESA`, `DIRECCIÓN`, `POBLACIÓN`, `TELÉFONO`, `RESPONSABLE`, `HISTORIAL`, `FECHA_BAJA`) VALUES
('CT01', 'BELTRÁN E HIJOS', 'LAS FUENTES 78', 'MADRID', '(914) 45- 64- 35', 'ANGEL MARTÍNEZ', '', NULL),
('CT04', 'EXPORTASA', 'VALLECAS 34', 'MADRID', '(913) 45- 23- 78', 'ELVIRA GÓMEZ', '', NULL),
('CT07', 'LA CASA DEL JUGUETE', 'AMÉRICA 45', 'MADRID', '(912) 64- 99- 87', 'ELÍAS PÉREZ', '', NULL),
('CT10', 'FERETERÍA EL CLAVO', 'PASEO DE ÁLAMOS 78', 'MADRID', '(914) 35- 48- 66', 'MANUEL MENÉNDEZ', '', NULL),
('CT14', 'DEPORTES GARCÍA', 'GUZMÁN EL BUENO 45', 'MADRID', '(913) 29- 94- 75', 'ANA JIMÉNEZ', '', NULL),
('CT19', 'CONFECCIONES GALÁN', 'FUENCARRAL 78', 'MADRID', '(913) 85- 92- 34', 'JUAN GARCÍA', '', NULL),
('CT23', 'EL PALACIO DE LA MODA', 'ORTEGA Y GASSET 129', 'MADRID', '(927) 78- 52- 35', 'LAURA CARRASCO', '', NULL),
('CT26', 'FERRETERÍA LA ESCOBA', 'ORENSE 7', 'MADRID', '(918) 45- 93- 46', 'JOSÉ GARCÍA', '', NULL),
('CT30', 'BAZAR EL ARGENTINO', 'ATOCHA 55', 'MADRID', '(912) 49- 59- 73', 'ADRIÁN ÁLVAREZ', '', NULL),
('CT34', 'BAZAR LA FARAONA', 'CASTILLA Y LEÓN 34', 'MADRID', '(915) 48- 36- 27', 'ANGEL SANTAMARÍA', '', NULL),
('CT36', 'JUGUETES EDUCATIVOS SANZ', 'ORENSE 89', 'MADRID', '(916) 87- 23- 54', 'PEDRO IGLESIAS', '', NULL),
('CT39', 'FERRETERÍA LIMA', 'VALLECAS 45', 'MADRID', '(913) 53- 27- 85', 'LUIS GARCÍA', '', NULL);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `EJEMPLO`
--

CREATE TABLE `EJEMPLO` (
  `DNI` varchar(10) NOT NULL,
  `NOMBRE` varchar(10) DEFAULT NULL,
  `APELLIDO` varchar(10) DEFAULT NULL,
  `EDAD` int(10) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `PEDIDOS`
--

CREATE TABLE `PEDIDOS` (
  `NÚMERODEPEDIDO` int(4) NOT NULL,
  `CÓDIGOCLIENTE` varchar(4) DEFAULT NULL,
  `FECHADEPEDIDO` varchar(10) DEFAULT NULL,
  `FORMADEPAGO` varchar(8) DEFAULT NULL,
  `DESCUENTO` int(1) DEFAULT NULL,
  `ENVIADO` varchar(9) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Volcado de datos para la tabla `PEDIDOS`
--

INSERT INTO `PEDIDOS` (`NÚMERODEPEDIDO`, `CÓDIGOCLIENTE`, `FECHADEPEDIDO`, `FORMADEPAGO`, `DESCUENTO`, `ENVIADO`) VALUES
(5, 'CT25', '31/03/2000', 'CONTADO', 0, 'FALSO'),
(7, 'CT12', '12/04/2000', 'CONTADO', 0, 'FALSO'),
(9, 'CT21', '21/04/2000', 'CONTADO', 0, 'FALSO'),
(12, 'CT06', '19/05/2001', 'CONTADO', 0, 'VERDADERO'),
(13, 'CT13', '30/04/2000', 'APLAZADO', 0, 'FALSO'),
(16, 'CT25', '11/05/2001', 'CONTADO', 0, 'FALSO'),
(21, 'CT16', '28/05/2001', 'CONTADO', 0, 'FALSO'),
(25, 'CT18', '02/06/2000', 'CONTADO', 0, 'FALSO'),
(26, 'CT09', '04/06/2001', 'APLAZADO', 0, 'VERDADERO'),
(28, 'CT28', '08/06/2000', 'APLAZADO', 0, 'FALSO'),
(30, 'CT02', '15/08/2000', 'CONTADO', 0, 'VERDADERO'),
(37, 'CT24', '02/07/2001', 'TARJETA', 0, 'VERDADERO'),
(39, 'CT20', '08/07/2001', 'TARJETA', 0, 'VERDADERO'),
(43, 'CT09', '18/07/2001', 'CONTADO', 0, 'FALSO'),
(46, 'CT31', '25/07/2002', 'CONTADO', 0, 'FALSO'),
(48, 'CT18', '30/08/2002', 'CONTADO', 0, 'FALSO'),
(49, 'CT28', '02/09/2002', 'CONTADO', 0, 'FALSO'),
(50, 'CT09', '05/09/2002', 'APLAZADO', 0, 'FALSO'),
(51, 'CT09', '05/09/2002', 'CONTADO', 0, 'VERDADERO'),
(63, 'CT28', '10/09/2000', 'CONTADO', 0, 'FALSO'),
(86, 'CT09', '24/12/2001', 'APLAZADO', 0, 'FALSO'),
(102, 'CT06', '12/01/2001', 'CONTADO', 0, 'VERDADERO'),
(103, 'CT02', '24/01/2001', 'CONTADO', 0, 'FALSO');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `PRODUCTOS`
--

CREATE TABLE `PRODUCTOS` (
  `CÓDIGOARTÍCULO` varchar(4) DEFAULT NULL,
  `SECCIÓN` varchar(10) DEFAULT NULL,
  `NOMBREARTÍCULO` varchar(19) DEFAULT NULL,
  `PRECIO` int(10) DEFAULT NULL,
  `FECHA` date DEFAULT NULL,
  `IMPORTADO` varchar(9) DEFAULT NULL,
  `PAÍSDEORIGEN` varchar(9) DEFAULT NULL,
  `FOTO` varchar(10) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Volcado de datos para la tabla `PRODUCTOS`
--

INSERT INTO `PRODUCTOS` (`CÓDIGOARTÍCULO`, `SECCIÓN`, `NOMBREARTÍCULO`, `PRECIO`, `FECHA`, `IMPORTADO`, `PAÍSDEORIGEN`, `FOTO`) VALUES
('AR01', 'FERRETERÍA', 'DESTORNILLADOR', 0, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR02', 'CONFECCIÓN', 'TRAJE CABALLERO', 285, '2010-03-23', 'VERDADERO', 'ITALIA', NULL),
('AR03', 'JUGUETERÍA', 'COCHE TELEDIRIGIDO', 159, '2010-03-23', 'VERDADERO', 'MARRUECOS', NULL),
('AR04', 'DEPORTIVOS', 'RAQUETA TENIS', 103, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR06', 'DEPORTIVOS', 'MANCUERNAS', 70, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR07', 'CONFECCIÓN', 'SERRUCHO', 70, '2010-03-23', 'VERDADERO', 'FRANCIA', NULL),
('AR08', 'JUGUETERÍA', 'CORREPASILLOS', 103, '2010-03-23', 'VERDADERO', 'JAPÓN', NULL),
('AR09', 'CONFECCIÓN', 'PANTALÓN SEÑORA', 174, '2010-03-23', 'VERDADERO', 'MARRUECOS', NULL),
('AR10', 'JUGUETERÍA', 'CONSOLA VIDEO', 443, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR11', 'CERÁMICA', 'TUBOS', 168, '2010-03-23', 'VERDADERO', 'CHINA', NULL),
('AR12', 'FERRETERÍA', 'LLAVE INGLESA', 24, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR13', 'CONFECCIÓN', 'CAMISA CABALLERO', 67, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR14', 'JUGUETERÍA', 'TREN ELÉCTRICO', 2, '2010-03-23', 'VERDADERO', 'JAPÓN', NULL),
('AR16', 'FERRETERÍA', 'ALICATES', 7, '2010-03-23', 'VERDADERO', 'ITALIA', NULL),
('AR17', 'JUGUETERÍA', 'MUÑECA ANDADORA', 105, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR18', 'DEPORTIVOS', 'PISTOLA OLÍMPICA', 57, '2010-03-23', 'VERDADERO', 'SUECIA', NULL),
('AR19', 'CONFECCIÓN', 'BLUSA SRA.', 101, '2010-03-23', 'VERDADERO', 'CHINA', NULL),
('AR20', 'CERÁMICA', 'JUEGO DE TE', 300, '2010-03-23', 'VERDADERO', 'CHINA', NULL),
('AR21', 'CERÁMICA', 'CENICERO', 20, '2010-03-23', 'VERDADERO', 'JAPÓN', NULL),
('AR22', 'FERRETERÍA', 'MARTILLO', 11, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR23', 'CONFECCIÓN', 'CAZADORA PIEL', 523, '2010-03-23', 'VERDADERO', 'ITALIA', NULL),
('AR24', 'DEPORTIVOS', 'BALÓN RUGBY', 122, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR25', 'DEPORTIVOS', 'BALÓN BALONCESTO', 85, '2010-03-23', 'VERDADERO', 'JAPÓN', NULL),
('AR26', 'JUGUETERÍA', 'FUERTE DE SOLDADOS', 144, '2010-03-23', 'VERDADERO', 'JAPÓN', NULL),
('AR27', 'CONFECCIÓN', 'ABRIGO CABALLERO', 500, '2010-03-23', 'VERDADERO', 'ITALIA', NULL),
('AR28', 'DEPORTIVOS', 'BALÓN FÚTBOL', 54, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR29', 'CONFECCIÓN', 'ABRIGO SRA', 360, '2010-03-23', 'VERDADERO', 'MARRUECOS', NULL),
('AR30', 'FERRETERÍA', 'DESTORNILLADOR', 9, '2010-03-23', 'VERDADERO', 'FRANCIA', NULL),
('AR31', 'JUGUETERÍA', 'PISTOLA CON SONIDOS', 57, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR32', 'DEPORTIVOS', 'CRONÓMETRO', 449, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR33', 'CERÁMICA', 'MACETA', 29, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR34', 'OFICINA', 'PIE DE LÁMPARA', 40, '2010-03-23', 'VERDADERO', 'TURQUÍA', NULL),
('AR35', 'FERRETERÍA', 'LIMA GRANDE', 22, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR36', 'FERRETERÍA', 'JUEGO DE BROCAS', 15, '2010-03-23', 'VERDADERO', 'TAIWÁN', NULL),
('AR37', 'CONFECCIÓN', 'CINTURÓN DE PIEL', 4, '2010-03-23', 'FALSO', 'ESPAÑA', NULL),
('AR38', 'DEPORTIVOS', 'CAÑA DE PESCA', 280, '2010-03-23', 'VERDADERO', 'USA', NULL),
('AR39', 'CERÁMICA', 'JARRA CHINA', 128, '2010-03-23', 'VERDADERO', 'CHINA', NULL),
('AR75', NULL, 'PANTALON', 50, '2010-03-23', NULL, 'EE.UU', NULL);

--
-- Disparadores `PRODUCTOS`
--
DELIMITER $$
CREATE TRIGGER `ACTUALIZA_PRODUCTOS_BU` BEFORE UPDATE ON `PRODUCTOS` FOR EACH ROW INSERT INTO PRODUCTOS_ACTUALIZADOS
    (
        ANTERIOR_CÓDIGOARTÍCULO,ANTERIOR_FECHA,ANTERIOR_IMPORTADO,ANTERIOR_NOMBREARTÍCULO,ANTERIOR_PAISDEORIGEN,ANTERIOR_PRECIO,ANTERIOR_SECCIÓN,NUEVO_CÓDIGOARTICULO,NUEVO_FECHA,NUEVO_IMPORTADO,NUEVO_NOMBREARTÍCULO,NUEVO_PAISDEORIGEN,NUEVO_PRECIO,NUEVO_SECCIÓN,USUARIO,F_MODIF
    ) 
    VALUES 
    (
        OLD.CÓDIGOARTÍCULO,OLD.FECHA,OLD.IMPORTADO,OLD.NOMBREARTÍCULO,OLD.PAÍSDEORIGEN,OLD.PRECIO,OLD.SECCIÓN,NEW.CÓDIGOARTÍCULO,NEW.FECHA,NEW.IMPORTADO,NEW.NOMBREARTÍCULO,NEW.PAÍSDEORIGEN,NEW.PRECIO,NEW.SECCIÓN,CURRENT_USER(),NOW()
    )
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `PRODUCTOS_AI` AFTER INSERT ON `PRODUCTOS` FOR EACH ROW INSERT INTO REG_PRODUCTOS(CÓDIGOARTÍCULO,NOMBREARTÍCULO,PRECIO,INSERTADO) VALUES (NEW.CÓDIGOARTÍCULO,NEW.NOMBREARTÍCULO,NEW.PRECIO,NOW())
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `PROD_ELIMINADOS_AD` AFTER DELETE ON `PRODUCTOS` FOR EACH ROW INSERT INTO PROD_ELIMINADOS
(
    C_ART,NOMBRE,PAIS_ORIGEN,PRECIO,SECCION,USUARIO,FECHA_MODIF
)
VALUES
(
    OLD.CÓDIGOARTÍCULO,OLD.NOMBREARTÍCULO,OLD.PAÍSDEORIGEN,OLD.PRECIO,OLD.SECCIÓN,CURRENT_USER(),NOW()
)
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `REVISA_PRECIO_BU` BEFORE UPDATE ON `PRODUCTOS` FOR EACH ROW BEGIN

            IF(NEW.PRECIO < 0) THEN

                SET NEW.PRECIO = 0;

            ELSEIF(NEW.PRECIO > 1000) THEN

                SET NEW.PRECIO = 1000;

            END IF;

        END
$$
DELIMITER ;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `PRODUCTOS_ACTUALIZADOS`
--

CREATE TABLE `PRODUCTOS_ACTUALIZADOS` (
  `ANTERIOR_CÓDIGOARTÍCULO` varchar(4) DEFAULT NULL,
  `ANTERIOR_NOMBREARTÍCULO` varchar(25) DEFAULT NULL,
  `ANTERIOR_SECCIÓN` varchar(15) DEFAULT NULL,
  `ANTERIOR_PRECIO` int(4) DEFAULT NULL,
  `ANTERIOR_IMPORTADO` varchar(15) DEFAULT NULL,
  `ANTERIOR_PAISDEORIGEN` varchar(15) DEFAULT NULL,
  `ANTERIOR_FECHA` date DEFAULT NULL,
  `NUEVO_CÓDIGOARTICULO` varchar(4) DEFAULT NULL,
  `NUEVO_NOMBREARTÍCULO` varchar(25) DEFAULT NULL,
  `NUEVO_SECCIÓN` varchar(15) DEFAULT NULL,
  `NUEVO_PRECIO` int(4) DEFAULT NULL,
  `NUEVO_IMPORTADO` varchar(15) DEFAULT NULL,
  `NUEVO_PAISDEORIGEN` varchar(15) DEFAULT NULL,
  `NUEVO_FECHA` date DEFAULT NULL,
  `USUARIO` varchar(15) DEFAULT NULL,
  `F_MODIF` date DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `PRODUCTOS_ACTUALIZADOS`
--

INSERT INTO `PRODUCTOS_ACTUALIZADOS` (`ANTERIOR_CÓDIGOARTÍCULO`, `ANTERIOR_NOMBREARTÍCULO`, `ANTERIOR_SECCIÓN`, `ANTERIOR_PRECIO`, `ANTERIOR_IMPORTADO`, `ANTERIOR_PAISDEORIGEN`, `ANTERIOR_FECHA`, `NUEVO_CÓDIGOARTICULO`, `NUEVO_NOMBREARTÍCULO`, `NUEVO_SECCIÓN`, `NUEVO_PRECIO`, `NUEVO_IMPORTADO`, `NUEVO_PAISDEORIGEN`, `NUEVO_FECHA`, `USUARIO`, `F_MODIF`) VALUES
('AR07', 'SERRUCHO', 'CONFECCIÓN', 50, 'VERDADERO', 'FRANCIA', '2010-03-23', 'AR07', 'SERRUCHO', 'CONFECCIÓN', 70, 'VERDADERO', 'FRANCIA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR20', 'JUEGO DE TE', 'CERÁMICA', 43, 'VERDADERO', 'CHINA', '2010-03-23', 'AR20', 'JUEGO DE TE', 'CERÁMICA', 300, 'VERDADERO', 'CHINA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR01', 'DESTORNILLADOR', 'FERRETERÍA', 7, 'FALSO', 'ESPAÑA', '2010-03-23', 'AR01', 'DESTORNILLADOR', 'FERRETERÍA', 15, 'FALSO', 'ESPAÑA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR01', 'DESTORNILLADOR', 'FERRETERÍA', 15, 'FALSO', 'ESPAÑA', '2010-03-23', 'AR01', 'DESTORNILLADOR', 'FERRETERÍA', 999, 'FALSO', 'ESPAÑA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR01', 'DESTORNILLADOR', 'FERRETERÍA', 999, 'FALSO', 'ESPAÑA', '2010-03-23', 'AR01', 'DESTORNILLADOR', 'FERRETERÍA', 30, 'FALSO', 'ESPAÑA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR01', 'DESTORNILLADOR', 'FERRETERÍA', 30, 'FALSO', 'ESPAÑA', '2010-03-23', 'AR01', 'DESTORNILLADOR', 'FERRETERÍA', 200, 'FALSO', 'ESPAÑA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR01', 'DESTORNILLADOR', 'FERRETERÍA', 200, 'FALSO', 'ESPAÑA', '2010-03-23', 'AR01', 'DESTORNILLADOR', 'FERRETERÍA', 1500, 'FALSO', 'ESPAÑA', '2010-03-23', 'root@localhost', '2021-01-23'),
('AR01', 'DESTORNILLADOR', 'FERRETERÍA', 1000, 'FALSO', 'ESPAÑA', '2010-03-23', 'AR01', 'DESTORNILLADOR', 'FERRETERÍA', -1500, 'FALSO', 'ESPAÑA', '2010-03-23', 'root@localhost', '2021-01-23');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `PRODUCTOS_NUEVOS`
--

CREATE TABLE `PRODUCTOS_NUEVOS` (
  `CÓDIGOARTÍCULO` varchar(4) DEFAULT NULL,
  `SECCIÓN` varchar(18) DEFAULT NULL,
  `NOMBREARTÍCULO` varchar(18) DEFAULT NULL,
  `PRECIO` varchar(8) DEFAULT NULL,
  `FECHA` varchar(10) DEFAULT NULL,
  `IMPORTADO` varchar(9) DEFAULT NULL,
  `PAÍSDEORIGEN` varchar(9) DEFAULT NULL,
  `FOTO` varchar(10) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Volcado de datos para la tabla `PRODUCTOS_NUEVOS`
--

INSERT INTO `PRODUCTOS_NUEVOS` (`CÓDIGOARTÍCULO`, `SECCIÓN`, `NOMBREARTÍCULO`, `PRECIO`, `FECHA`, `IMPORTADO`, `PAÍSDEORIGEN`, `FOTO`) VALUES
('AR50', 'ALTA COSTURA', 'TRAJE CABALLERO', '1.284,58', '11/03/2002', 'VERDADERO', 'ITALIA', NULL),
('AR51', 'DEPORTES DE RIESGO', 'RAQUETA TENIS', '1.093,47', '20/03/2000', 'VERDADERO', 'USA', NULL),
('AR52', 'DEPORTES DE RIESGO', 'MANCUERNAS', '1.060,00', '13/09/2000', 'VERDADERO', 'USA', NULL),
('AR53', 'ALTA COSTURA', 'SERRUCHO', '1.030,20', '23/03/2001', 'VERDADERO', 'FRANCIA', NULL),
('AR54', 'ALTA COSTURA', 'PANTALÓN SEÑORA', '1.174,23', '10/01/2000', 'VERDADERO', 'MARRUECOS', NULL),
('AR55', 'ALTA COSTURA', 'CAMISA CABALLERO', '1.067,13', '11/08/2002', 'FALSO', 'ESPAÑA', NULL),
('AR56', 'DEPORTES DE RIESGO', 'PISTOLA OLÍMPICA', '1.046,73', '02/02/2001', 'VERDADERO', 'SUECIA', NULL),
('AR57', 'ALTA COSTURA', 'BLUSA SRA.', '1.101,06', '18/03/2000', 'VERDADERO', 'CHINA', NULL),
('AR58', 'ALTA COSTURA', 'CAZADORA PIEL', '1.522,69', '10/07/2001', 'VERDADERO', 'ITALIA', NULL),
('AR59', 'DEPORTES DE RIESGO', 'BALÓN RUGBY', '1.111,64', '11/11/2000', 'VERDADERO', 'USA', NULL),
('AR60', 'DEPORTES DE RIESGO', 'BALÓN BALONCESTO', '1.075,27', '25/06/2001', 'VERDADERO', 'JAPÓN', NULL),
('AR61', 'ALTA COSTURA', 'ABRIGO CABALLERO', '1.500,00', '05/04/2002', 'VERDADERO', 'ITALIA', NULL),
('AR62', 'DEPORTES DE RIESGO', 'BALÓN FÚTBOL', '1.043,91', '04/07/2002', 'FALSO', 'ESPAÑA', NULL),
('AR63', 'ALTA COSTURA', 'ABRIGO SRA', '1.360,07', '03/05/2001', 'VERDADERO', 'MARRUECOS', NULL),
('AR64', 'DEPORTES DE RIESGO', 'CRONÓMETRO', '1.439,18', '03/01/2002', 'VERDADERO', 'USA', NULL),
('AR65', 'ALTA COSTURA', 'CINTURÓN DE PIEL', '1.004,33', '12/05/2002', 'FALSO', 'ESPAÑA', NULL),
('AR66', 'DEPORTES DE RIESGO', 'CAÑA DE PESCA', '1.270,00', '14/02/2000', 'VERDADERO', 'USA', NULL),
('AR67', 'DEPORTES DE RIESGO', 'BOTA ALPINISMO', '1.144,00', '05/05/2002', 'FALSO', 'ESPAÑA', NULL),
('AR68', 'DEPORTES DE RIESGO', 'PALAS DE PING PONG', '1.021,60', '02/02/2002', 'FALSO', 'ESPAÑA', NULL);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `PROD_ELIMINADOS`
--

CREATE TABLE `PROD_ELIMINADOS` (
  `C_ART` varchar(4) DEFAULT NULL,
  `NOMBRE` varchar(19) DEFAULT NULL,
  `PAIS_ORIGEN` varchar(15) DEFAULT NULL,
  `PRECIO` decimal(6,3) DEFAULT NULL,
  `SECCION` varchar(10) DEFAULT NULL,
  `USUARIO` varchar(15) DEFAULT NULL,
  `FECHA_MODIF` date DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `PROD_ELIMINADOS`
--

INSERT INTO `PROD_ELIMINADOS` (`C_ART`, `NOMBRE`, `PAIS_ORIGEN`, `PRECIO`, `SECCION`, `USUARIO`, `FECHA_MODIF`) VALUES
('AR15', 'PLATO DECORATIVO', 'CHINA', '54.000', 'CERÁMICA', NULL, NULL),
('AR40', 'BOTA ALPINISMO', 'ESPAÑA', '154.000', 'DEPORTIVOS', 'root@localhost', '2021-01-23');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `PRUEBA`
--

CREATE TABLE `PRUEBA` (
  `ID` int(20) UNSIGNED NOT NULL,
  `DNI` int(10) UNSIGNED NOT NULL,
  `NOMBRE` varchar(10) NOT NULL,
  `NOMBRE2` varchar(10) NOT NULL,
  `APELLIDO` varchar(10) NOT NULL,
  `APELLIDO2` varchar(10) NOT NULL,
  `EDAD` int(4) UNSIGNED NOT NULL,
  `FECHA_NACIMIENTO` date DEFAULT NULL,
  `LUGAR_NACIMIENTO` varchar(20) DEFAULT 'DESCONOCIDO'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `REG_PRODUCTOS`
--

CREATE TABLE `REG_PRODUCTOS` (
  `CÓDIGOARTÍCULO` varchar(25) NOT NULL,
  `NOMBREARTÍCULO` varchar(30) NOT NULL,
  `PRECIO` int(10) UNSIGNED NOT NULL,
  `INSERTADO` datetime NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `REG_PRODUCTOS`
--

INSERT INTO `REG_PRODUCTOS` (`CÓDIGOARTÍCULO`, `NOMBREARTÍCULO`, `PRECIO`, `INSERTADO`) VALUES
('AR75', 'PANTALON', 50, '2021-01-23 13:56:57');

-- --------------------------------------------------------

--
-- Estructura para la vista `art_deportes`
--
DROP TABLE IF EXISTS `art_deportes`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `art_deportes`  AS SELECT `productos`.`NOMBREARTÍCULO` AS `NOMBREARTÍCULO`, `productos`.`SECCIÓN` AS `SECCIÓN`, `productos`.`PAÍSDEORIGEN` AS `PAÍSDEORIGEN` FROM `productos` WHERE `productos`.`PAÍSDEORIGEN` = 'ESPAÑA' ;

--
-- Índices para tablas volcadas
--

--
-- Indices de la tabla `CLIENTES`
--
ALTER TABLE `CLIENTES`
  ADD PRIMARY KEY (`CÓDIGOCLIENTE`);

--
-- Indices de la tabla `PEDIDOS`
--
ALTER TABLE `PEDIDOS`
  ADD PRIMARY KEY (`NÚMERODEPEDIDO`),
  ADD KEY `CÓDIGOCLIENTE` (`CÓDIGOCLIENTE`) USING BTREE;

--
-- Indices de la tabla `PRUEBA`
--
ALTER TABLE `PRUEBA`
  ADD PRIMARY KEY (`ID`);

--
-- Indices de la tabla `REG_PRODUCTOS`
--
ALTER TABLE `REG_PRODUCTOS`
  ADD PRIMARY KEY (`CÓDIGOARTÍCULO`);

--
-- AUTO_INCREMENT de las tablas volcadas
--

--
-- AUTO_INCREMENT de la tabla `PRUEBA`
--
ALTER TABLE `PRUEBA`
  MODIFY `ID` int(20) UNSIGNED NOT NULL AUTO_INCREMENT;

--
-- Restricciones para tablas volcadas
--

--
-- Filtros para la tabla `PEDIDOS`
--
ALTER TABLE `PEDIDOS`
  ADD CONSTRAINT `fk` FOREIGN KEY (`CÓDIGOCLIENTE`) REFERENCES `CLIENTES` (`CÓDIGOCLIENTE`) ON DELETE CASCADE ON UPDATE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
